---
title: Migrazione da package.config a formati PackageReference
description: Informazioni dettagliate su come eseguire la migrazione di un progetto dal formato gestione package.config a PackageReference come supportato da NuGet 4.0 + e VS2017 e 2.0 di .NET Core
author: karann-msft
ms.author: karann
manager: unnir
ms.date: 03/27/2018
ms.topic: conceptual
ms.openlocfilehash: 2b15d60d4f71fb2777e36c6a948ad72b4e2bc594
ms.sourcegitcommit: 3eab9c4dd41ea7ccd2c28bb5ab16f6fbbec13708
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/26/2018
---
# <a name="migrate-from-packagesconfig-to-packagereference"></a><span data-ttu-id="bc54a-103">La migrazione da Packages. config a PackageReference</span><span class="sxs-lookup"><span data-stu-id="bc54a-103">Migrate from packages.config to PackageReference</span></span>

<span data-ttu-id="bc54a-104">Visual Studio 2017 versione 15.7 Preview 3 e versioni successive è supportata la migrazione di un progetto dal [Packages](./packages-config.md) formato di gestione per il [PackageReference](../consume-packages/Package-References-in-Project-Files.md) formato.</span><span class="sxs-lookup"><span data-stu-id="bc54a-104">Visual Studio 2017 Version 15.7 Preview 3 and later supports migrating a project from the [packages.config](./packages-config.md) management format to the [PackageReference](../consume-packages/Package-References-in-Project-Files.md) format.</span></span>

## <a name="benefits-of-using-packagereference"></a><span data-ttu-id="bc54a-105">Vantaggi dell'utilizzo PackageReference</span><span class="sxs-lookup"><span data-stu-id="bc54a-105">Benefits of using PackageReference</span></span>

* <span data-ttu-id="bc54a-106">**Gestire tutte le dipendenze di progetto in un'unica posizione**: come riferimenti da progetto a progetto e riferimenti all'assembly fa riferimento a pacchetto NuGet (usando il `PackageReference` nodo) vengono gestite direttamente all'interno di file di progetto anziché un oggetto separato file Packages. config.</span><span class="sxs-lookup"><span data-stu-id="bc54a-106">**Manage all project dependencies in one place**: Just like project to project references and assembly references, NuGet package references (using the `PackageReference` node) are managed directly within project files rather than using a separate packages.config file.</span></span>
* <span data-ttu-id="bc54a-107">**Si riempia di elementi di visualizzazione delle dipendenze di primo livello**: a differenza dei file Packages. config, PackageReference Elenca solo i pacchetti di NuGet è installato direttamente nel progetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-107">**Uncluttered view of top-level dependencies**: Unlike packages.config, PackageReference lists only those NuGet packages you directly installed in the project.</span></span> <span data-ttu-id="bc54a-108">Di conseguenza, la UI di gestione pacchetti NuGet e il file di progetto non sono chiara con dipendenze di livello inferiore.</span><span class="sxs-lookup"><span data-stu-id="bc54a-108">As a result, the NuGet Package Manager UI and the project file aren't cluttered with down-level dependencies.</span></span>
* <span data-ttu-id="bc54a-109">**Miglioramenti delle prestazioni**: quando si utilizza PackageReference, i pacchetti vengono mantenuti nel *globale pacchetti* cartella (come descritto in [gestione dei pacchetti globali e alla cartella della cache](../consume-packages/managing-the-global-packages-and-cache-folders.md) piuttosto che in un `packages` cartella all'interno della soluzione.</span><span class="sxs-lookup"><span data-stu-id="bc54a-109">**Performance improvements**: When using PackageReference, packages are maintained in the *global-packages* folder (as described on [Managing the global packages and cache folders](../consume-packages/managing-the-global-packages-and-cache-folders.md) rather than in a `packages` folder within the solution.</span></span> <span data-ttu-id="bc54a-110">Di conseguenza, PackageReference assicura prestazioni più rapide e utilizza meno spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="bc54a-110">As a result, PackageReference performs faster and consumes less disk space.</span></span>
* <span data-ttu-id="bc54a-111">**Fine di controllare le dipendenze e il flusso del contenuto**: tramite le funzionalità esistenti di MSBuild consente [in modo condizionale fanno riferimento a un pacchetto NuGet](../consume-packages/Package-References-in-Project-Files.md#adding-a-packagereference-condition) scegliere pacchetto fa riferimento al framework di destinazione, configurazione, piattaforma o altri punti.</span><span class="sxs-lookup"><span data-stu-id="bc54a-111">**Fine control over dependencies and content flow**: Using the existing features of MSBuild allows you to [conditionally reference a NuGet package](../consume-packages/Package-References-in-Project-Files.md#adding-a-packagereference-condition) and choose package references per target framework, configuration, platform, or other pivots.</span></span>
* <span data-ttu-id="bc54a-112">**PackageReference è in fase di sviluppo**: vedere [PackageReference problemi su GitHub](https://aka.ms/nuget-pr-improvements).</span><span class="sxs-lookup"><span data-stu-id="bc54a-112">**PackageReference is under active development**: See [PackageReference issues on GitHub](https://aka.ms/nuget-pr-improvements).</span></span> <span data-ttu-id="bc54a-113">file Packages. config non è più in fase di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="bc54a-113">packages.config is no longer under active development.</span></span>

### <a name="limitations"></a><span data-ttu-id="bc54a-114">Limitazioni</span><span class="sxs-lookup"><span data-stu-id="bc54a-114">Limitations</span></span>

* <span data-ttu-id="bc54a-115">NuGet PackageReference non è disponibile in Visual Studio 2015 e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="bc54a-115">NuGet PackageReference is not available in Visual Studio 2015 and earlier.</span></span> <span data-ttu-id="bc54a-116">Progetti migrati possono essere aperti solo in Visual Studio 2017.</span><span class="sxs-lookup"><span data-stu-id="bc54a-116">Migrated projects can be opened only in Visual Studio 2017.</span></span>
* <span data-ttu-id="bc54a-117">Migrazione non è attualmente disponibile per il progetto C++ e ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="bc54a-117">Migration is not currently available for C++ and ASP.NET project.</span></span>
* <span data-ttu-id="bc54a-118">Alcuni pacchetti potrebbero non essere completamente compatibili con PackageReference.</span><span class="sxs-lookup"><span data-stu-id="bc54a-118">Some packages may not be fully compatible with PackageReference.</span></span> <span data-ttu-id="bc54a-119">Per altre informazioni, vedere [problemi di compatibilità del pacchetto](#package-compatibility-issues).</span><span class="sxs-lookup"><span data-stu-id="bc54a-119">For more information, see [package compatibility issues](#package-compatibility-issues).</span></span>

## <a name="migration-steps"></a><span data-ttu-id="bc54a-120">Passaggi della migrazione</span><span class="sxs-lookup"><span data-stu-id="bc54a-120">Migration steps</span></span>

> [!Note]
> <span data-ttu-id="bc54a-121">Prima di inizia la migrazione, Visual Studio crea un backup del progetto per poter [ripristinare Packages](#how-to-roll-back-to-packagesconfig) se necessario.</span><span class="sxs-lookup"><span data-stu-id="bc54a-121">Before migration begins, Visual Studio creates a backup of the project to allow you to [roll back to packages.config](#how-to-roll-back-to-packagesconfig) if necessary.</span></span>

1. <span data-ttu-id="bc54a-122">Aprire una soluzione contenente progetti tramite `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="bc54a-122">Open a solution containing project using `packages.config`.</span></span>

1. <span data-ttu-id="bc54a-123">In **Esplora soluzioni**, fare clic sui **riferimenti** nodo o il `packages.config` file e selezionare **migrare PackageReference Packages. config...** .</span><span class="sxs-lookup"><span data-stu-id="bc54a-123">In **Solution Explorer**, right-click on the **References** node or the `packages.config` file and select **Migrate packages.config to PackageReference...**.</span></span>

1. <span data-ttu-id="bc54a-124">La migrazione Analizza riferimenti del pacchetto NuGet del progetto e tenta di suddividere in categorie **dipendenze di primo livello** (NuGet pacchetti tale directory è stato installato) e **dipendenze Transitive**(pacchetti che sono stati installati come dipendenze dei pacchetti di primo livello).</span><span class="sxs-lookup"><span data-stu-id="bc54a-124">The migrator analyzes the project's NuGet package references and attempts to categorize them into **Top-level dependencies** (NuGet packages that you installed directory) and **Transitive dependencies** (packages that were installed as dependencies of top-level packages).</span></span>

   > [!Note]
   > <span data-ttu-id="bc54a-125">PackageReference supporta ripristino del pacchetto transitiva e consente di risolvere le dipendenze in modo dinamico, vale a dire che non è necessario installare le dipendenze transitive in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="bc54a-125">PackageReference supports transitive package restore and resolves dependencies dynamically, meaning that transitive dependencies need not be installed explicitly.</span></span>

1. <span data-ttu-id="bc54a-126">(Facoltativo) È possibile scegliere di considerare un pacchetto NuGet classificato come una dipendenza transitiva come dipendenza di livello superiore, selezionare il **primo livello** opzione per il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-126">(Optional) You may choose to treat a NuGet package classified as a transitive dependency as a top-level dependency by selecting the **Top-Level** option for the package.</span></span> <span data-ttu-id="bc54a-127">Questa opzione viene impostata automaticamente per i pacchetti che contengono risorse che non passano in modo transitivo (quelli presenti il `build`, `buildCrossTargeting`, `contentFiles`, oppure `analyzers` cartelle) e quelli contrassegnati come una dipendenza di sviluppo (`developmentDependency = "true"`).</span><span class="sxs-lookup"><span data-stu-id="bc54a-127">This option is automatically set for packages containing assets that do not flow transitively (those in the `build`, `buildCrossTargeting`, `contentFiles`, or `analyzers` folders) and those marked as a development dependency (`developmentDependency = "true"`).</span></span>

1. <span data-ttu-id="bc54a-128">Rivedere le [problemi di compatibilità del pacchetto](#package-compatibility-issues).</span><span class="sxs-lookup"><span data-stu-id="bc54a-128">Review any [package compatibility issues](#package-compatibility-issues).</span></span>

1. <span data-ttu-id="bc54a-129">Selezionare **OK** per avviare la migrazione.</span><span class="sxs-lookup"><span data-stu-id="bc54a-129">Select **OK** to begin the migration.</span></span>

1. <span data-ttu-id="bc54a-130">Al termine della migrazione, Visual Studio fornisce un report con un percorso per il backup, l'elenco dei pacchetti installati (dipendenze di primo livello), un elenco di pacchetti di cui viene fatto riferimento come dipendenze transitive e un elenco dei problemi di compatibilità identificato all'inizio di migrazione.</span><span class="sxs-lookup"><span data-stu-id="bc54a-130">At the end of the migration, Visual Studio provides a report with a path to the backup, the list of installed packages (top-level dependencies), a list of packages referenced as transitive dependencies, and a list of compatibility issues identified at the start of migration.</span></span> <span data-ttu-id="bc54a-131">Il report viene salvato nella cartella di backup.</span><span class="sxs-lookup"><span data-stu-id="bc54a-131">The report is saved to the backup folder.</span></span>

1. <span data-ttu-id="bc54a-132">Verificare che la soluzione si basa e viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="bc54a-132">Validate that the solution builds and runs.</span></span> <span data-ttu-id="bc54a-133">Se si verificano problemi, [file di un problema in GitHub](https://github.com/NuGet/Home/issues/).</span><span class="sxs-lookup"><span data-stu-id="bc54a-133">If you encounter problems, [file an issue on GitHub](https://github.com/NuGet/Home/issues/).</span></span>

## <a name="how-to-roll-back-to-packagesconfig"></a><span data-ttu-id="bc54a-134">Come eseguire il rollback a Packages. config</span><span class="sxs-lookup"><span data-stu-id="bc54a-134">How to roll back to packages.config</span></span>

1. <span data-ttu-id="bc54a-135">Chiudere il progetto migrato.</span><span class="sxs-lookup"><span data-stu-id="bc54a-135">Close the migrated project.</span></span>

1. <span data-ttu-id="bc54a-136">Copiare il file di progetto e `packages.config` dal backup (in genere `<solution_root>\MigrationBackup\<unique_guid>\<project_name>\`) nella cartella di progetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-136">Copy the project file and `packages.config` from the backup (typically `<solution_root>\MigrationBackup\<unique_guid>\<project_name>\`) to the project folder.</span></span>

1. <span data-ttu-id="bc54a-137">Aprire il progetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-137">Open the project.</span></span>

1. <span data-ttu-id="bc54a-138">Aprire la Console di gestione pacchetti utilizzando il **strumenti > Gestione pacchetti NuGet > Console di gestione pacchetti** comando di menu.</span><span class="sxs-lookup"><span data-stu-id="bc54a-138">Open the Package Manager Console using the **Tools > NuGet Package Manager > Package Manager Console** menu command.</span></span>

1. <span data-ttu-id="bc54a-139">Eseguire il comando seguente nella Console:</span><span class="sxs-lookup"><span data-stu-id="bc54a-139">Run the following command in the Console:</span></span>

   ```ps
   update-package -reinstall
   ```

## <a name="package-compatibility-issues"></a><span data-ttu-id="bc54a-140">Problemi di compatibilità dei pacchetti</span><span class="sxs-lookup"><span data-stu-id="bc54a-140">Package compatibility issues</span></span>

<span data-ttu-id="bc54a-141">Alcuni aspetti di cui sono supportate in Packages. config non sono supportati in PackageReference.</span><span class="sxs-lookup"><span data-stu-id="bc54a-141">Some aspects that were supported in packages.config are not supported in PackageReference.</span></span> <span data-ttu-id="bc54a-142">La migrazione analizza e rileva tali problemi.</span><span class="sxs-lookup"><span data-stu-id="bc54a-142">The migrator analyzes and detects such issues.</span></span> <span data-ttu-id="bc54a-143">I pacchetti che include uno o più dei seguenti problemi potrebbero non comportarsi come previsto dopo la migrazione.</span><span class="sxs-lookup"><span data-stu-id="bc54a-143">Any package that has one or more of the following issues may not behave as expected after the migration.</span></span>

### <a name="installps1-scripts-are-ignored-when-the-package-is-installed-after-the-migration"></a><span data-ttu-id="bc54a-144">"install.ps1" script vengono ignorati quando il pacchetto viene installato dopo la migrazione</span><span class="sxs-lookup"><span data-stu-id="bc54a-144">"install.ps1" scripts are ignored when the package is installed after the migration</span></span>

| | |
| --- | --- |
| <span data-ttu-id="bc54a-145">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="bc54a-145">**Description**</span></span> | <span data-ttu-id="bc54a-146">Con PackageReference, gli script di PowerShell install.ps1 e uninstall.ps1 non vengono eseguiti durante l'installazione o disinstallazione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-146">With PackageReference, install.ps1 and uninstall.ps1 PowerShell scripts are not executed while installing or uninstalling a package.</span></span> |
| <span data-ttu-id="bc54a-147">**Impatto potenziale**</span><span class="sxs-lookup"><span data-stu-id="bc54a-147">**Potential impact**</span></span> | <span data-ttu-id="bc54a-148">I pacchetti che dipendono da questi script per configurare il comportamento di alcuni nel progetto di destinazione potrebbero non funzionare come previsto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-148">Packages that depend on these scripts to configure some behavior in the destination project might not work as expected.</span></span> |

### <a name="content-assets-are-not-available-when-the-package-is-installed-after-the-migration"></a><span data-ttu-id="bc54a-149">Asset "contenuto" non sono disponibili quando il pacchetto viene installato dopo la migrazione</span><span class="sxs-lookup"><span data-stu-id="bc54a-149">"content" assets are not available when the package is installed after the migration</span></span>

| | |
| --- | --- |
| <span data-ttu-id="bc54a-150">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="bc54a-150">**Description**</span></span> | <span data-ttu-id="bc54a-151">Gli asset in un pacchetto `content` cartella non sono supportate con PackageReference e vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="bc54a-151">Assets in a package's `content` folder are not supported with PackageReference and are ignored.</span></span> <span data-ttu-id="bc54a-152">PackageReference aggiunge il supporto per `contentFiles` meglio transitivo supporto e contenuto condiviso.</span><span class="sxs-lookup"><span data-stu-id="bc54a-152">PackageReference adds support for `contentFiles` to have better transitive support and shared content.</span></span>  |
| <span data-ttu-id="bc54a-153">**Impatto potenziale**</span><span class="sxs-lookup"><span data-stu-id="bc54a-153">**Potential impact**</span></span> | <span data-ttu-id="bc54a-154">Gli asset in `content` non vengono copiati nel progetto e progetto codice che dipende dalla presenza di tali risorse richiede il refactoring.</span><span class="sxs-lookup"><span data-stu-id="bc54a-154">Assets in `content` are not copied into the project and project code that depends on the presence of those assets requires refactoring.</span></span>  |

### <a name="xdt-transforms-are-not-applied-when-the-package-is-installed-after-the-upgrade"></a><span data-ttu-id="bc54a-155">Le trasformazioni XDT non vengono applicate quando il pacchetto viene installato dopo l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="bc54a-155">XDT transforms are not applied when the package is installed after the upgrade</span></span>

| | |
| --- | --- |
| <span data-ttu-id="bc54a-156">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="bc54a-156">**Description**</span></span> | <span data-ttu-id="bc54a-157">Le trasformazioni XDT non sono supportate con PackageReference e `.xdt` i file vengono ignorati durante l'installazione o disinstallazione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-157">XDT transforms are not supported with PackageReference and `.xdt` files are ignored when installing or uninstalling a package.</span></span>   |
| <span data-ttu-id="bc54a-158">**Impatto potenziale**</span><span class="sxs-lookup"><span data-stu-id="bc54a-158">**Potential impact**</span></span> | <span data-ttu-id="bc54a-159">Trasformazioni XDT non vengono applicate a qualsiasi file XML di progetto, in genere, `web.config.install.xdt` e `web.config.uninstall.xdt`, ovvero il progetto` web.config` file non viene aggiornato quando il pacchetto viene installato o disinstallato.</span><span class="sxs-lookup"><span data-stu-id="bc54a-159">XDT transforms are not applied to any project XML files, most commonly, `web.config.install.xdt` and `web.config.uninstall.xdt`, which means the project's` web.config` file is not updated when the package is installed or uninstalled.</span></span> |

### <a name="assemblies-in-the-lib-root-are-ignored-when-the-package-is-installed-after-the-migration"></a><span data-ttu-id="bc54a-160">Gli assembly nella directory principale lib vengono ignorati quando il pacchetto viene installato dopo la migrazione</span><span class="sxs-lookup"><span data-stu-id="bc54a-160">Assemblies in the lib root are ignored when the package is installed after the migration</span></span>

| | |
| --- | --- |
| <span data-ttu-id="bc54a-161">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="bc54a-161">**Description**</span></span> | <span data-ttu-id="bc54a-162">Con PackageReference, gli assembly presentano nella radice della `lib` cartella senza una destinazione framework specifici sottocartella vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="bc54a-162">With PackageReference, assemblies present at the root of `lib` folder without a target framework specific sub-folder are ignored.</span></span> <span data-ttu-id="bc54a-163">NuGet Cerca una sottocartella moniker del framework di destinazione (TFM) corrispondente al framework di destinazione del progetto di corrispondenza e installa gli assembly corrispondenti nel progetto.</span><span class="sxs-lookup"><span data-stu-id="bc54a-163">NuGet looks for a sub-folder matching the target framework moniker (TFM) corresponding to the project’s target framework and installs the matching assemblies into the project.</span></span> |
| <span data-ttu-id="bc54a-164">**Impatto potenziale**</span><span class="sxs-lookup"><span data-stu-id="bc54a-164">**Potential impact**</span></span> | <span data-ttu-id="bc54a-165">I pacchetti che non dispongono di una sottocartella corrispondenza moniker del framework di destinazione (TFM) corrispondente al framework di destinazione del progetto non venga si comportano come previsto al termine della transizione o non riuscire durante la migrazione</span><span class="sxs-lookup"><span data-stu-id="bc54a-165">Packages that do not have a sub-folder matching the target framework moniker (TFM) corresponding to the project’s target framework may not behave as expected after the transition or fail installation during the migration</span></span> |

## <a name="found-an-issue-report-it"></a><span data-ttu-id="bc54a-166">Rilevato un problema?</span><span class="sxs-lookup"><span data-stu-id="bc54a-166">Found an issue?</span></span> <span data-ttu-id="bc54a-167">Segnalarlo!</span><span class="sxs-lookup"><span data-stu-id="bc54a-167">Report it!</span></span>

<span data-ttu-id="bc54a-168">Se si esegue un problema con l'esperienza di migrazione, eseguire [file di un problema nel repository NuGet GitHub](https://github.com/NuGet/Home/issues/).</span><span class="sxs-lookup"><span data-stu-id="bc54a-168">If you run into a problem with the migration experience, please [file an issue on the NuGet GitHub repository](https://github.com/NuGet/Home/issues/).</span></span>
